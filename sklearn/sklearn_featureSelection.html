<!DOCTYPE html>
<html>
<head><meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>sklearn_featureSelection</title><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>


<link rel="stylesheet" type="text/css" href="/static/css/md_notebook.css" />


<!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML-full,Safe"> </script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: "AMS",
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                CommonHTML: {
                    linebreaks: { 
                    automatic: true 
                    }
                }
            });
        
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        }
    }
    init_mathjax();
    </script>
    <!-- End of mathjax configuration --></head>
<body class="jp-Notebook" data-jp-theme-light="true" data-jp-theme-name="JupyterLab Light">

<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>chapter 10 数据表达与特征工程</p>

</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<h1 id="%E6%95%B0%E6%8D%AE%E8%A1%A8%E8%BE%BE">&#25968;&#25454;&#34920;&#36798;<a class="anchor-link" href="#%E6%95%B0%E6%8D%AE%E8%A1%A8%E8%BE%BE">&#182;</a></h1>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<h2 id="%E4%BD%BF%E7%94%A8%E5%93%91%E5%8F%98%E9%87%8F%E8%BD%AC%E5%8C%96%E7%B1%BB%E5%9E%8B%E7%89%B9%E5%BE%81">&#20351;&#29992;&#21713;&#21464;&#37327;&#36716;&#21270;&#31867;&#22411;&#29305;&#24449;<a class="anchor-link" href="#%E4%BD%BF%E7%94%A8%E5%93%91%E5%8F%98%E9%87%8F%E8%BD%AC%E5%8C%96%E7%B1%BB%E5%9E%8B%E7%89%B9%E5%BE%81">&#182;</a></h2>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[1]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 导入 pandas</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">fruits</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;value&quot;</span><span class="p">:[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span>
                      <span class="s2">&quot;type&quot;</span><span class="p">:[</span><span class="s2">&quot;waterMelon&quot;</span><span class="p">,</span> <span class="s2">&quot;banana&quot;</span><span class="p">,</span> <span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="s2">&quot;grape&quot;</span><span class="p">]})</span>
<span class="n">display</span><span class="p">(</span><span class="n">fruits</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>value</th>
      <th>type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5</td>
      <td>waterMelon</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6</td>
      <td>banana</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7</td>
      <td>orange</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8</td>
      <td>apple</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9</td>
      <td>grape</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[2]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 转化数据表中的字符串为数值</span>
<span class="n">fruits_dum</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">fruits</span><span class="p">)</span>
<span class="n">fruits_dum</span>

<span class="c1"># 数值列并没有变化，分类列变成了0-1矩阵</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[2]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>value</th>
      <th>type_apple</th>
      <th>type_banana</th>
      <th>type_grape</th>
      <th>type_orange</th>
      <th>type_waterMelon</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[3]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 令程序将数值也看做字符串</span>
<span class="n">fruits</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fruits</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="c1">#先将数值转为字符串，这一句可选，但是推荐加上。</span>
<span class="c1"># 用 get_dummies 转化为字符串</span>
<span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">fruits</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[3]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>type</th>
      <th>value_5</th>
      <th>value_6</th>
      <th>value_7</th>
      <th>value_8</th>
      <th>value_9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>waterMelon</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>banana</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>orange</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>apple</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>grape</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<h2 id="%E5%AF%B9%E6%95%B0%E6%8D%AE%E8%BF%9B%E8%A1%8C%E8%A3%85%E7%AE%B1%E5%A4%84%E7%90%86">&#23545;&#25968;&#25454;&#36827;&#34892;&#35013;&#31665;&#22788;&#29702;<a class="anchor-link" href="#%E5%AF%B9%E6%95%B0%E6%8D%AE%E8%BF%9B%E8%A1%8C%E8%A3%85%E7%AE%B1%E5%A4%84%E7%90%86">&#182;</a></h2>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[4]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 产生数据</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">rnd</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">38</span><span class="p">)</span>
<span class="n">x</span><span class="o">=</span><span class="n">rnd</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="c1"># 向数据集添加噪音</span>
<span class="n">y_no_noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span><span class="n">x</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_no_noise</span> <span class="o">+</span> <span class="n">rnd</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span><span class="o">/</span><span class="mi">2</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[5]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 分别使用 MLP 算法和 KNN 算法 对这个数据集进行回归分析</span>

<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>

<span class="c1"># 生成一个等差数列</span>
<span class="n">line</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">mlpr</span><span class="o">=</span><span class="n">MLPRegressor</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">knr</span><span class="o">=</span><span class="n">KNeighborsRegressor</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">mlpr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">line</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MLP&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">knr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">line</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;KNN&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 肉眼可见，MLP更平滑，而KNN覆盖更多的点。</span>
<span class="c1"># 该采用哪一个呢？</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[6]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 对数据进行一下“装箱处理”(binning)，也称为“离散化处理”(discretization)</span>

<span class="c1"># 设置箱子个数11</span>
<span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="c1">#将数据进行装箱处理</span>
<span class="n">target_bin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;装箱范围:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">bins</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;前10个数据点的特征值:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">X</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;前10个数据点的箱子:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">target_bin</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>装箱范围:
 [-5. -4. -3. -2. -1.  0.  1.  2.  3.  4.  5.]
前10个数据点的特征值:
 [[-1.1522688 ]
 [ 3.59707847]
 [ 4.44199636]
 [ 2.02824894]
 [ 1.33634097]
 [ 1.05961282]
 [-2.99873157]
 [-1.12612112]
 [-2.41016836]
 [-4.25392719]]
前10个数据点的箱子:
 [[ 4]
 [ 9]
 [10]
 [ 8]
 [ 7]
 [ 7]
 [ 3]
 [ 4]
 [ 3]
 [ 1]]
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<h3 id="OneHotEncoder">OneHotEncoder<a class="anchor-link" href="#OneHotEncoder">&#182;</a></h3>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[7]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># sklearn 的 OneHotEncoder 和 pandas 的 get_dummies 功能基本一致，但是 OneHotEncoder 目前只能用于整型数值的类型变量。</span>

<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>
<span class="n">onehot</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">onehot</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">target_bin</span><span class="p">)</span>
<span class="n">X_in_bin</span><span class="o">=</span><span class="n">onehot</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">target_bin</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;装箱前的数据形态:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">target_bin</span><span class="o">.</span><span class="n">shape</span> <span class="p">)</span> <span class="c1">#50行1列</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;装箱后的数据形态:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">X_in_bin</span><span class="o">.</span><span class="n">shape</span> <span class="p">)</span> <span class="c1">#50行10列</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;装箱后的前10个数据点:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">X_in_bin</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>装箱前的数据形态:
 (50, 1)
装箱后的数据形态:
 (50, 10)
装箱后的前10个数据点:
 [[0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 1. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[8]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 分别使用 MLP 算法和 KNN 算法 对这个新数据集进行回归分析</span>

<span class="c1"># 使用独热编码进行数据表达</span>
<span class="n">line2</span><span class="o">=</span><span class="n">onehot</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">))</span>

<span class="n">mlpr2</span><span class="o">=</span><span class="n">MLPRegressor</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_in_bin</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">knr2</span><span class="o">=</span><span class="n">KNeighborsRegressor</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_in_bin</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">mlpr2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">line2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MLP&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">knr2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">line2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;KNN&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;OneHotEncode&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 在x&gt;0部分，2个拟合几乎完全重合。</span>
<span class="c1"># 对比 OneHotEncode 编码前，MLP回归模型变得更复杂；而KNN模型变得更简单。</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>装箱的好处：可以纠正模型过拟合或者欠拟合的问题。</p>
<ul>
<li>尤其是对大规模高纬度的数据集使用线性模型的时候，装箱处理可以大幅提高线性模型的预测准确度。</li>
<li>装箱对于决策树算法没有太多作用，因为这类算法本身就是不停地拆分样本的特征数据，所以不需要再使用装箱操作。 </li>
</ul>

</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<h1 id="%E6%95%B0%E6%8D%AE%E2%80%9C%E5%8D%87%E7%BB%B4%E2%80%9D">&#25968;&#25454;&#8220;&#21319;&#32500;&#8221;<a class="anchor-link" href="#%E6%95%B0%E6%8D%AE%E2%80%9C%E5%8D%87%E7%BB%B4%E2%80%9D">&#182;</a></h1>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>交叉式特征（Interaction Features）和多项式特征(Polynomial Features)</p>

</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<h2 id="%E4%BA%A4%E5%8F%89%E5%BC%8F%E7%89%B9%E5%BE%81%EF%BC%88Interaction-Features%EF%BC%89">&#20132;&#21449;&#24335;&#29305;&#24449;&#65288;Interaction Features&#65289;<a class="anchor-link" href="#%E4%BA%A4%E5%8F%89%E5%BC%8F%E7%89%B9%E5%BE%81%EF%BC%88Interaction-Features%EF%BC%89">&#182;</a></h2>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[1]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 交叉式特征（Interaction Features） 就是在原始特征中添加交互项。</span>

<span class="c1"># 测试 np.hstack() 函数</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">arr1</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="n">arr2</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">]</span>
<span class="n">arr3</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span> <span class="p">[</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">]</span> <span class="p">)</span>
<span class="n">arr3</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[1]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
<pre>array([ 1,  2,  3,  4, 10, 30, 40, 50])</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[2]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 把原始数据和装箱后的数据堆叠</span>
<span class="c1"># 产生数据</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">rnd</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">38</span><span class="p">)</span>
<span class="n">x</span><span class="o">=</span><span class="n">rnd</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="c1"># 向数据集添加噪音</span>
<span class="n">y_no_noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span><span class="n">x</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_no_noise</span> <span class="o">+</span> <span class="n">rnd</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span><span class="o">/</span><span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;X</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">X</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span>


<span class="c1"># 对数据进行一下“装箱处理”(binning)，也称为“离散化处理”(discretization)</span>
<span class="c1"># 设置箱子个数11</span>
<span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="c1"># 将数据进行装箱处理</span>
<span class="n">target_bin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">target_bin</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">target_bin</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span>

<span class="c1"># OneHotEncoder 只能输入整型</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>
<span class="n">onehot</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">onehot</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">target_bin</span><span class="p">)</span>
<span class="n">X_in_bin</span><span class="o">=</span><span class="n">onehot</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">target_bin</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">X_in_bin</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">X_in_bin</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span>

<span class="c1"># 按列拼接</span>
<span class="n">X_stack</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">X</span><span class="p">,</span> <span class="n">X_in_bin</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_stack</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1">#(50, 1) (50, 11) 由1列，变为11列。后10列是编码后的。</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>X
 [[-1.1522688 ]
 [ 3.59707847]
 [ 4.44199636]]

target_bin
 [[ 4]
 [ 9]
 [10]]

X_in_bin
 [[0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 1. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]]
(50, 1) (50, 11)
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[3]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 分别使用 MLP 算法和 KNN 算法 对这个数据集进行回归分析</span>

<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>

<span class="c1"># 生成一个等差数列</span>
<span class="n">line</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># 使用独热编码进行数据表达</span>
<span class="n">line2</span><span class="o">=</span><span class="n">onehot</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span> <span class="p">)</span>

<span class="c1">#将数据进行堆叠</span>
<span class="n">line_stack</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span> <span class="p">[</span><span class="n">line</span><span class="p">,</span> <span class="n">line2</span><span class="p">]</span> <span class="p">)</span>

<span class="c1"># 训练数据</span>
<span class="n">mlpr3</span><span class="o">=</span><span class="n">MLPRegressor</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_stack</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">knr3</span><span class="o">=</span><span class="n">KNeighborsRegressor</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_stack</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># 绘图</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">mlpr3</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">line_stack</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MLP&quot;</span><span class="p">)</span>
<span class="c1">#plt.plot(line, knr3.predict(line_stack), label=&quot;KNN&quot;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="k">for</span> <span class="n">vline</span> <span class="ow">in</span> <span class="n">bins</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">vline</span><span class="p">,</span> <span class="n">vline</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;After adding interaction&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 每个数据所在的箱体中，MLP增加了斜率。</span>
<span class="c1"># 模型复杂度提高了。</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<h3 id="%E4%BA%A4%E5%8F%89%E7%9B%B8">&#20132;&#21449;&#30456;<a class="anchor-link" href="#%E4%BA%A4%E5%8F%89%E7%9B%B8">&#182;</a></h3>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[4]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 每个箱体中的斜率基本一致了，但是这不是我们需要的。我们希望每个箱体都有各自的截距和斜率。</span>
<span class="n">X_multi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">X_in_bin</span><span class="p">,</span> <span class="n">X</span><span class="o">*</span><span class="n">X_in_bin</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_in_bin</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">X_multi</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1">#(50, 20)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_multi</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>(50, 1) (50, 10)
(50, 20)
[ 0.         0.         0.         1.         0.         0.
  0.         0.         0.         0.        -0.        -0.
 -0.        -1.1522688 -0.        -0.        -0.        -0.
 -0.        -0.       ]
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[5]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 每个箱子内都有自己的斜率</span>

<span class="c1"># 训练数据</span>
<span class="n">mlpr4</span><span class="o">=</span><span class="n">MLPRegressor</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_multi</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">knr4</span><span class="o">=</span><span class="n">KNeighborsRegressor</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_multi</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1">#将数据进行堆叠</span>
<span class="n">line_multi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span> <span class="p">[</span><span class="n">line2</span><span class="p">,</span> <span class="n">line</span> <span class="o">*</span> <span class="n">line2</span><span class="p">]</span> <span class="p">)</span>

<span class="c1"># 绘图</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">mlpr4</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">line_multi</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MLP&quot;</span><span class="p">)</span>
<span class="c1">#plt.plot(line, knr3.predict(line_stack), label=&quot;KNN&quot;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="k">for</span> <span class="n">vline</span> <span class="ow">in</span> <span class="n">bins</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">vline</span><span class="p">,</span> <span class="n">vline</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Adding multiply&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 线性模型在低维度表现不好，在高纬度表现良好。所以可以升维后使用glm模型。</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<h2 id="%E5%A4%9A%E9%A1%B9%E5%BC%8F%E7%89%B9%E5%BE%81(Polynomial-Features)">&#22810;&#39033;&#24335;&#29305;&#24449;(Polynomial Features)<a class="anchor-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E7%89%B9%E5%BE%81(Polynomial-Features)">&#182;</a></h2>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>多项式: y = a<em>x^4 + b</em>x^3 + c<em>x^2 + d</em>x + e</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[6]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 导入多项式特征工具</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">PolynomialFeatures</span>

<span class="c1"># 向数据集添加多项式特征</span>
<span class="n">poly</span><span class="o">=</span><span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">include_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">X_poly</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_poly</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1">#degree=20 就是变成20列</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>(50, 1) (50, 20)
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[7]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 检验一下各项怎么来的, 第一个是1次方，第二个是2次方，类推。</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_poly</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">feature_names:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">())</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>[-1.1522688] [1.3277234] [-1.52989425  1.76284942 -2.0312764   2.34057643]
[ -1.1522688    1.3277234   -1.52989425   1.76284942  -2.0312764
   2.34057643  -2.6969732    3.10763809  -3.58083443   4.1260838
  -4.75435765   5.47829801  -6.3124719    7.27366446  -8.38121665
   9.65741449 -11.12793745  12.82237519 -14.77482293  17.02456756]

feature_names:
 [&#39;x0&#39; &#39;x0^2&#39; &#39;x0^3&#39; &#39;x0^4&#39; &#39;x0^5&#39; &#39;x0^6&#39; &#39;x0^7&#39; &#39;x0^8&#39; &#39;x0^9&#39; &#39;x0^10&#39;
 &#39;x0^11&#39; &#39;x0^12&#39; &#39;x0^13&#39; &#39;x0^14&#39; &#39;x0^15&#39; &#39;x0^16&#39; &#39;x0^17&#39; &#39;x0^18&#39; &#39;x0^19&#39;
 &#39;x0^20&#39;]
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[8]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 尝试线性回归</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="n">lr_poly</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_poly</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">line_poly</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

<span class="c1"># 绘制图形</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">lr_poly</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">line_poly</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Linear Regressor&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 这个线性拟合可不是直线！低维数据集，线性拟合通常欠拟合，但是进行多项式扩展后，可以一定程度解决欠拟合问题。</span>

<span class="c1"># 除了将特征转为多项式的方法之外，我们还可以用类似正弦函数 sin(), 对数函数 log(), 或指数函数 exp() 等来进行相似的操作。</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAXIAAAD4CAYAAADxeG0DAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAA84ElEQVR4nO2deXiU1dn/P2eWbGQFEgQSwiKyg0hYrBsqFVtFcKlvfeNS0WKrdau1VWlfbZW6tfb9iai11WrbVEtFbVVc8BVqwTXsu6zZWBKy79uc3x8zk4RkZjLLM5k8yf25Lq4kM8+cOQP6fe58z70orTWCIAiCebFEegOCIAhCaIiQC4IgmBwRckEQBJMjQi4IgmByRMgFQRBMji0Sbzp48GA9cuTIoF5bWtvEkYp6JgxNxGZRAJRUN3KsqoFJwxKxKGXgTgVBEHoPGzduPKG1Tu38eESEfOTIkeTm5gb12pc3HOKht3fx8S++ycABUQD88T8HeeTd3ax76CISY+xGblUQBCEk6ppaeG7dAf5rZgbpKXEhraWUyvP0eMjWilIqRin1pVJqq1Jqp1Lql6Gu6Qt31rulQ+Btdf3Q0io58YIg9C5yPs9n+cf7eerDr8P2HkZE5I3ABVrrGqWUHVivlHpPa/25AWt3weHSakW7ktuszvtRi8MRjrcUBEEIms8PlgKw+1h12N4j5IhcO6lx/Wh3/QlbaNxWidohIrdJRC4IQi/lQIlTHg+dqMHhCI9GGZK1opSyKqW2AMXAGq31Fx6uWaKUylVK5ZaUlIT8nhYPQt4apr8kQRCEYGhudVBYXk+s3UpDs4OqhuawvI8hQq61btVanw6kA7OUUpM9XPOC1jpLa52Vmtrl0NVvHK6IXKmO1orz++ZWsVYEQeg9FJXX0+LQZI1MAeBETVNY3sfQPHKtdQWwFrjYyHVPfg/n145JhjaL82NIRC4IQm/icGktAGeMcAp5WW0vFXKlVKpSKtn1fSzwTWBPqOt6oz1rpUNEbnFH5CLkgiD0Ho5UNAAwLSMJgNKaxrC8jxFZK0OBV5RSVpw3hpVa63cMWNcj7dZK+2PurBWJyAVB6E0UVzegFIweHA9AdUNLWN4nZCHXWm8DphuwFz/fr+tjbRG5pB8KgtCLKK5uZGBcFClxzuLF6sbwCLlpe61YPBx2SkQuCEJvoriqgdSEaOJjnDFzdW/OWulJ3HmYSio7BUHo5RRXN5KWGIPVooiLslITJmvFdELuluqOWSt2qewUBMEocnJoHTECbbFQPywdnZMT9FLFVY2kJUQDEB9t670eeU/j9sg7WittEblYK4IghEJODo7vfx9rfT0AsUeLaLrpZqIAsrMDWsrh0JyoaWRIYruQ1zZJRA54zlqxu/LIxVoRBCEU9AMPYHGJuJuoxgbq770v4LXK6ppocWjSEmIAiHZVd4YD0wl5m7XiISJvFWtFEIRQKCjw+HD00aL2Pk9+UlzlzBl3WyvRNguNLa2h7c8LphNytKbz7Ai7VQqCBEEIjcaWVo4leW4fciRxMHnL/wAjR4LF4vzajXdeXO0sBkpzWSsxdgsNzSLkgLONbecZQFZpmiUIQoi8v+MYj559Ha0xsSc9ruPiWDd2FsN+eifk5TkP6vLyYMkSn2LeHpHHQE4OzzxwBX//4dl+3QQCxXRCrtEn2SrQnrUiTbMEQQiWv32Rz9ZzL0H94Q+Qmek8iMvMRL3wAt/O20RUY8PJL6irg6VLva7njsiHvLMKlixhcOkxLPh3EwgU8wm5PrmFLUhELghCaOwvruGLQ2V8d+YILNdmw+HD4HA4v2Znk1J6zPML8/O9rllc3UhijI2o//mFU/Q70s1NIFBMJ+ROa+VkJW9rYytCLgj9j5ycgLxrT7y5uRCrRXHVjHSPzzvSMzy/cMQIr2uWuIqBvIq9j5tAoJhOyDVdTfK2NrZirQhC/yInx2lTBOBdd0Zrzertx5gzeiCprgyTzlgf/TUN9k7PxcXBsmVe1y2udhUDeRN7HzeBQDGdkOPDWpGCIEHoZyxdGrJtsfd4NYdO1PLtKUO9X5SdzYd3PUxRYira5Z3zwgs+i4RKqhudN4Zly5yi35FubgKBYrrKTofWXawVd/qhCLkg9DMMsC1Wbz+GRcFFE0/xed2AG6/nLMtEXlsyhzmjB/m8VmtNcXUDqfHRcKlT7Kt+/FPii4+iRmSgfv3rgCtFfWG6iFxruuSRy2GnIPRTDLAt3tt+lFmjvNsqbmZkOqf8bMwr73bNmsYWGpodbTnkZGfz17//m9E/e5vG/QcNFXEwo5Bzcp8VaC/Rl/RDQehnhGhb7Dtezb7iGt+2iovkuCjGpsWTe7is22uLq5055B1vDjE2K0BYioJMJ+ROa+VkLBaFUhKRC0K/Izvb6VV3yPvuzrvuyHs7jqEUzJ/k21ZxkzUyhY155W3ttL1RUt2hGMhFjN0t5MYHnKYTcq3pWtqJMyqXEn1B6Idkd8379pfV24+SlZnCkMSY7i8GpmekUNXQ0jZU2RseI3K7U24lInfR2VoBp08uTbMEQfCXAyU17DlW7Zet4mbycOcQ5e1FlT6va4/I24U82m2thKFxlumE3OGhaRY4i4IkIhcEwV/e3+Gs1rx4sn+2CsDYIfFE2yxsL/Qh5Dk5XHXl2Rx8fAFJE8a25bS7I/JGsVZcWSseHrdZlHjkgmBWDKjODJTV248yfUQyQ5Niu7/Yhd1qYcLQRO8RuatAKan4CBY0Kj+/rUCp3SOXiByN9mit2KwWGfUmCGaho3APHgyLF4dUnRkoh07UsvNIFZcEYKu4mTI8iZ1HqjwfePooUIq2uSLyFonInb1WPFkrFiUTggTBDHQuqy8thaamk68xuKlUZ1ZvPwoQkD/uZsrwJGoavRx4+ihQsoVxtnDIQq6UylBKrVVK7VJK7VRK3WnExrzhHNLhKSJXUtkpCEYTDsvDU9TqCQObSnXmnW1HmZGZwrBk/20VNz4PPH0UKIVzAI4REXkLcI/WeiIwB7hNKTXRgHW9oLv0WgFn4ywRckEwEAMaUnnEX4E2sKlURw6U1LD7aHC2CnRz4LlsGdpLgVI45yaELORa66Na602u76uB3cDwUNf1hsPh3VqR9ENBMBADGlJ5xB+BNripVEdWbwveVoFuDjyzszn65NMUemiuZXM39+ulEXkbSqmRwHTgCw/PLVFK5SqlcktKSoJ+D03XplngzCOX9ENBMJBw9dH2VFZvt8OgQUFVZwaC1pq3thQxc2QKpyT5VwTkCV8HnnsvWMDZP/wTmw+XnlSg1KsjcjdKqXhgFXCX1rqq8/Na6xe01lla66zUVM8DTv3B04QgcP4lSfqhIBhIuPpoeyqr/9Of4MSJoKozA2FTfgUHSmr5zgwvgyL8xH3gecjDgWdhRT0Awzv57+1C3ksjcqWUHaeI52it3zBiTW84s1a8ReRirQh9gAjkVHsknH20QyirD4WVXxUQF2XlkqnB2SpupmY4Dzy3FVZ0ee5IRT12q3K2sO2Ara3ddi+MyJVTVV8Edmutnwp9S77ReL6b2a1SECT0AcJ1wBgM7sh5UIfe27GBZ3n4orGllaKKevYX11BQVheWYhk3tY0tvLPtCJdOHcqA6NBGMYxNSyAuysrWgq4++ZGKeoYmxWLpZB2EMyI3YrDEWcB1wHal1BbXYw9orVcbsHZXtDNQ6YxV8siFvoCvA8Yeilq7UF/f/n1pqfPGAgHvx+HQ7DpaxecHS/niUBl7jlVRWF7vSiluZ3hyLLNGDeSSKUM5b1xqmwCGyhubi6htauXqrNBsFXDqzZThSWwuqOjyXGF5PcOSu/rv7emHxkfkIQu51no9nqvmw4KnCUHgvNvVtrT01DYEITz0wKDegAjxxtLS6uDLQ2Ws3nGUD3Yeb2smNXJQHNMzUrjyjHSGJsUQY7fS1OKguLqRnUcqWbe3mDc3FzEsKYZbzz+V72SltzWdCoZWh+aP/znItIzktgERQZOTA0uX8lp+PkcSUmlO/A32665re/pgSQ0XT+5q3bhvSC29Uch7Go3n9EOrRQqChD7AiBFOO8XT40bgEiHy851rLlvmW5CDuLE4HJovD5fx1uYiPtx1nLLaJmLtVs4fn8o3Jw7hzNGDu80YaW51sG5vCc+t28/P39rBnzYc4vErp5I1cqA/n7ILH+w8Rl5pHT+7eLzHMza/cVtfdXUoYHhVMY5bbnHaBNnZlNU2UV7XzJjUAV1e6k4/7K3WSo/izFrxUNlpsYi1IpifZcvahKINow4YO4gQ0O6/g3cxD+DGcvhELW9sKuSNzUUUltczIMrKhROG8O0pp3DeaWnERvkfUdtfe5VvLl3KvPx8Gk4ZzuPnXMdVJbXccGYm931rQkBrNbc6+M0HexmdOsDvARJe8fAbiqW+vu03lAMlNQCMSYvv8lKlFLYwJWWYTsg9TQgCV68VKQgSzI5bUAOJmv0lGJukmxtLfVMrb289wsrcAnLzylEKzj51MD+5aBzzJ50SkOC20SnqjT1ayIPv/D+m/CCJez6D/+w7wW+vnsb0Ef5ZJDmf53HwRC0v3pDVNt83aLr5DeXr49UAnJraVcjBaa+EwzkwnZB7abWCVXqtCH2F7OzwHGwG4797ubEcnr+Iv76zi39sLKSy3mkl/PTicVw+fXhAbWE94uGGo+rquHLVcwz9KJef/GMrVz73Kbedfyp3XDjW52Ho4RO1PPnBXs4ZO5gLxqeFti/w+huKzshAAVsLKkiJs5Oe4vnvwDk3oRemH/Y4XqwVu/QjFwTfBFvg0yHnO3fdJhY3n8bc36zj5U8Pc87Yway85Uw++vF53Dr31NBFHHzecL5x6mDev/tcFk0fzvKP93P5sxvY54qCO1NZ18wtf9mI1aJ4/MqpoXnjbjzk1tfZosm7x9m2YEtBBdMykr2+l91qESEH79aKVTxyQfBNkAU+Wms27D/Bd1/4jKue/4wtBRXcNW8sn953Ac/89xnMGjXQGJF0080NJzHGzlNXn87z157BkYoGLlm+nmfX7aeyvrnt0u2FlVz1/KccOlHLs9kzgupy6JFOVamOQYNosEWRedcPaB2RyYS1b3OGD8vHbg1PmrT5rBVvEblVPHJB8EkQ/vvOI5Use3c3nx4oZUhiNL+4dCLXzMogLiqM0uHnge/Fk4cyI3Mg97+xnSfe38v/frSPsWnx1De3crCklkEDonj5xpl849TBxu7PbX3l5GBZsoSBDc59WgvyefToM1RePAEuHOvxpbYwDYk3nZB7m9kpBUGC4Ad++u/Hqxp48oO9rNpUSHKsnQcXTOS/Z48IKZc7oD2CXzec1IRo/nhDFtsLK3l72xG+Pl6N3Wrhmpkj+K9ZGSTG2MO3Tw9eflxLI3FPPAy33uTxJVG28FgrphNyb1IdrtNgQehPOByav36RxxPv76WpxcGSc0Zz6/mnkhQbRkH0RIAHvlPSk5iSnhR4nnwoBHF4HK7sOvMJuRdrxRmRi7UiCMGy73g1972xnY155Zx96mCWXT6ZzEFdC1t6LcHkyYdCEMVbNmt4rBXTHXZqL9aKjHoThODQWvPyhkNc8vR6DpbU8NTV0/jLTbPMJeIQvkEY3gji8DgqTOmH5ovI8TF8WYRcEAKiqqGZ+1ZtY/X2Y1w4Po0nrprKoE7tV01DT/epCeLw2GYNT3adKSNybyX6rQ6N7txKTRAEj+woqmTB8vV8sPM4939rPH+4Piv8Ih7OXuvhGoThiwD7qoerRN90Qu7Qnlstts3Dk6hc6G8EKI5aa/76eR5XPPcpjc0O/r5kDrecN6ZL/+yw7DOcvdbDOQjDIMKVtWI6IXeW6HuIyF1lulLdKfQrAhTHmsYW7nxtCz9/awdzRg/i3TvODrqjYMCE28P2NEIuTLM/gyVcFrD5hFxrjzM721tESuaKECS9ZcRaIAQgjnuOVXHZ8vW8s+0I984fx8vfm9mzfnhPeNgRGiHnL+HKWjHfYac3a8U1fUMiciEoejp1zSj8EEetNf/ILeQX/9xBYqydnJvncOaYQZ5fF07C3WvdBERJrxUnGu2xr4N45EJI9HTqmlF0c8BX19TCPf/Yyk9XbWNGZgqr7zgnMiIOpvCww43NGp56F/MJucaztdI2RkmEXAiC3jZizV98iOO+49UsfGYDb24u4s4Lx/KXm2aTmhDB1EITeNjhxi4FQU68zey0tkXk4pELQRCJ1DUI3Zf3Io5vTDiPy57ZQFltE39ePIu7v3la6EMVjKCXe9jhJlwl+qYTcq3xaJK7J1RLRC4ERSR+7TcqHa+DODbsO8DPoqfw45VbmZKexOo7z+Gcsalh2b4QOFaLIhz5GOYTcjxbK1aLy1oRj1wIhkj82m+wL3+wpIZFKzbw99wCbp07hr/dPJshib6HHAs9i1PIpUTf1Wul6/3HLtaKECrhGrHmDQN9+X9tPcL9q7Zht1n40/dmcr4RY80Ew7GGaZKZIRG5UuolpVSxUmqHEev5QmvPvVbaPHKxVgSzYIAv39Dcyv1vbOeOVzcz7pQEVt9xTv8TcRPl/1tVLxZy4GXgYoPW8onTWvE0IUisFcFkhOjL7y+uZtGKDbz6ZT63nDeav99ypnEjzcxCuMv+DcZqVbSGoR+UIUKutf4EKDNire7wNSEICIv/JAhhifpC8OVf31jIguUbKK5u5E83zuT+b03wOU2+z2Ky/P9wReQ95pErpZYASwBGhJDS5e1m1l6iLxG5YDDhrPoM0JevbWzhF//cwRubipg9aiBPXzO9fx9omiz/39abPXJ/0Fq/oLXO0lpnpaYGnw7lzVqRpllC2OglUd+Ookoue2Z9W4HP374/p3+LOEQu/z9ILBaFQ2N4u23T/S7mbUKQVUr0hXAR4aiv1aFZsXY/i1ZsoKaxhZybZveeAp9IY7Kyf5slPD2hTJh+6LlpVntBkHjkgsFEsNlTfmkdd6/cwsa8ci6ZOpRliyaTHBcV9vc1DUFM6Ykklg4Bp81q3LqGCLlS6lVgLjBYKVUIPKi1ftGItTuj8TwhSCJyIWwsW3ayRw5hj/q01qzMLeBXb+/CYlH8v++ezmXThnlsGNfv6en8/xBwR+QOg60VQ4Rca32NEev4g8PhOY/cLk2zhHDRw1FfXmktS9/cwfr9Jzhz9CB+c/U0hve3tMI+ijsINTrgNJ+1AngyV6RplhBWeiDqa2l18OL6Q/zuo6+xWSw8vHAS2bMzwz+CTegx2jxygwNO8wm5lwlBdotE5IJ5+exAKb96Zxe7j1Yxb8IQHl40iaFJEoX3NdrqXXqjtdKTeC3RlwlBggnJK63l0dV7iFr5Kn9a/xeGVJZARgbK9mvT+L6C/7ib+0nWCp77kbubZjWLtSKYgLzSWlas3c8bm4q4fPc6fr1mBfbGBueT+fnmGDMnBIy7+NZoITdhHrmzSroz1jDlZwqCUWit+fxgKbe/upkLfvtv/rnlCNfOyeSxja+1i7ibnio4MlHDqb6AROQuvE0Icld2Som+0JvQWrPzSBUf7jrOu9uOcKCkloQYGzd+YyRLzh1NWmIMLCr0/OJwFxyZdeC0iQlXRG46IdfgsSLIJk2zhAjQ6tA0tThobGmlvrmV41WNFJTVkVday5aCSrYUlHOipgmLgqyRA/nBeWO4dOowYqM6VINEquDIV+sBEfKwEK4BOKYTcrS3XitSECQYR2V9M7mHy9hSUEFeaR1FFfVU1TdT39xKfVMrjS7x9vUb4OjUAZx7WipzRg3iwglpDIr3Mvg4AgVHQMRbD/RHrKoXFwT1JE5rpSs2ST8UQkRrzdq9xbz6ZQFr9xTT4tBYLYphyTGkJ8dxalo8sXYrMVFWYu1Wom0Wom1Wou0Wom0WomwW0hJiyBgYS3pKHPHRfv7vFaky8wi2HuivhGsAjumEXON9QpBSEpELncjJOVkgv/1tWL26i2Buyi/nl2/vYmtBBYPjo7nxrJFcMH4Ip2ckn2yDhItIlJlH6jeBfoy1N5fo9yTai7UCTp9cmmYJbXg6zHvuufbn8/LQS5bwzrYj3GmZyJDEGJ64ciqXnzG8fwxpMFnDqb6ALUw9oUwn5N6sFXDaK5J+KLTh6TCvE6qujunPP8lVL67hF5dOJCHG3kOb6yWYqOFUX8AibWydaI3nPrY473aSfii04eeh3fDqEzxx1bQwb0YQwteP3JS/P3q1VqxK0g+Fdvw8tFNGH+5JkY3gBbd29Xsh92WtWC0WmsVaEdx4mB7T5b8Oow/3TDbVXehZbGHqCWU6IffWNAtcg03FWhHceJhSv3NRNoWJqegAp9b7TS+Z7yn0Ttoi8n4/s9PLhCBw3u2kaZZwEtnZcPgwOBxs+mQzl42/hl8/+x60tjofN/qgT4psBB+EqwLddELu6C4iF2tF8EBdUwv3rNzK0KRYHr9yavhGpplsqrvQs7Q39zN2XdMJufbWbAVn4yyp7BQ88dh7ezhcWstvvjMtvCmGJpvqLvQsVonI3XieEATu9EOxVoST2VJQwV8+z+N73xjJmWMGhffNPPjyhvvwgmkJ15B40+WR+7JW7FaLlOgLJ+FwaB785w5S46O556JxPfOmUmQjeCFccxNMF5E7Z3b6OOyUiFzowMrcArYWVrL0kgn+N7EShDBhlTxyJw7ttbATu9UiQi60UdXQzBMf7GXWyIFcNm1YpLcjCL07IldKXayU2quU2q+Uus+INb2htfaacWC3KjnsFNr4wycHKatt4n8WTAxfloogBECvFXKllBVYAXwLmAhco5SaGOq63vDWxhYkIhfaOVHTyIvrD3HJ1KFMHp4U6e0IAtAhj7wXFgTNAvZrrQ9qrZuA14CFBqzrEa3xOLMTnN0PpWmWALBi7X4aWxzc883TIr0V45AeLqYnXN0PjRDy4UBBh58LXY+dhFJqiVIqVymVW1JSEvSbOa0Vz89F2eSwU4CiinpyPs/nqjPSGZ0aH+ntGIP0cOkTmL77odb6Ba11ltY6KzU1Nfh1wEceeR9IP5SoK2Se+Xg/AHfOGxvhnRiI9HDpE/TmfuRFQEaHn9Ndj4UFh8/DTpN75J4m2ixZ4vxe8pL94nhVA6s2FvKdrHSGJcdGejvGIT1c+gS9OSL/ChirlBqllIoCvgv8y4B1PaJ9ph+a3FqRqCtkXlp/iBaHgyXnjo70VoxFerj0Cdw1MEY7ByELuda6BfgR8AGwG1iptd4Z6rpe3w+8RuQ2s6cfStQVEpV1zfz18zwunTqMzEEDIr0dY5EeLn0Cd0Tu6G1CDqC1Xq21Pk1rPUZrHdb/snwddtqtFprMHJFL1BUSf/0ij9qmVn5w3phIb8V4pIdLnyBcvVZMV9np21oxefdDibqCpr6plZfWH2LuuFQmDkuM9HbCQ4fe6mHppS6EHaUUFtU7PfIexXdBkMk9com6guYfGwsorW3ih30xGhf6FBalcBhcEGS6LkJaa58FQS0O7bOMv9cjnfMCprnVwe//fZAZmSnMGjUw0tsRBJ9YLAqjs6RNF5GD94g8yub8OFLd2b94Z9sRiirq+eF5Y8x7Axf6DRblDEgNXdPQ1XoAXx/f1naQYGJ7RXDiZ2GUw6F5bt0BThsSzwXj03p0i4IQDBZl/EhK8wm5j8NOm9UVkbdIRG5qAihHX7u3mK+P1/DDuWPaquYEoTdjVWKtOPHy63OU1fl4s0Tk5iaAwqjn1h1geHIsl06NYL9xaasgBIBSGH7YaSohd/tK3UXkpk5BFPwujPryUBm5eeUsOXc0dmuE/lOWZlZCgFgtxmetmEzInV99FQQB5k5BFPwujHp23X4GDYji6qwMz9f3BNJWQQiQfu+Ruz+6t/RDu9taESE3N34URu08Usm6vSUsPnsUsVHWHt5gB6StghAg/T79sM1a6TYiF2vF1PhRGPXsugPER9u4dk5mBDeKtFUQAsaiemmvlZ6iPSL3jDv9UCJyk9Lx0HDpUmcE7qEc/dCJWt7bfpRr52SSFGuP2HYBaasgBEw4KjvNJeTikfddAjg0/P2/D2CzWlh89sie32dnpK2CECCW/p5+qHFbK94HS4DxncWEHsDPQ8NjlQ2s2lTI1VnppCXE9I7UP2lmJQSAxdLv0w99P29zH3a2SEQeMuEWyM7r5+V5vq7ToeGKtfvRGm45d4znKP666+DWW43dqyAYiLW/WytuurVWJCIPjXDnRnta39s/aodDw4KyOl77Kp+rZ2aQMTDOcxSvNTz/vORxC72Wfp9+2B12icjbCSWiDndutDcB7izmnQ4Nl3+8D6UUt19wqvMBbyl+Wkset9BrsVhUt+5CwGsau1x4aTvs9JpH7vbI+7mQhxpRhzs32pcAezk0PFhSw6pNRVw7O5OhSa6hyr5S/CSPW+il9PvBEu2HnZ6fd0fkTYHmkfeGAzMjCTWi7iY3urGllcLyOo5VNgTXjtPb+pmZXg8NH3tvD9E2Cz+c22FwxLJlflkygtCb6PeDJdojcs+0ReSBpB+6o1e38LmjVzBv9kGoEfWyZSf/nQDExVH005+zLGcjH+8ppqHZ+XecHGfnW5OH8v1zRjE6NT6k9b3lXq/fd4IPdx3n3vnjSE2Ibn8iOxs2bHB64h3/x5A8bqEXI+mHrq/egrCgmmb1xV4ZoVYbdsqN1iNG8OFdD3Nu4TA27C/l6qwMHr9yCg8vnMTc01J5a3MR3/zdJzz8zi4amlsDXt9X7nVzq4Nfvr2TEQPjuOnsUV3XevZZ+MtfJI9bMA3hSD80WUTu7n7oxSO3uK2VACLyvtgrI8CI1yOukXNaa5a+tYO/fZHPgmlDeXjhJJLjotouu+7MkZyoaeSpNV/z4vpDrN1bzO+vncHYIQl+rd8df/zPIfYV1/D762YQY/fSU0XG4wkmot+nH3YXkQdlrfTFXhkGVhs+teZr/vZFPrecN5qnv3v6SSLuZnB8NL++fAp/vWk2VfUtXP7sp6zZdTzkj/H18Wp+t+ZrvjX5FC6aOCTk9QShN6B6W/qhUuo7SqmdSimHUirLqE15w++CoECslb7aK8OAasOPdh1n+cf7+e7MDO67eHy38zDPHjuYt28/i9GpA/j+n3NZ/n/7gp5N2NDcyt1/30J8jI2HF02WWZxCn8HaC9MPdwBXAJ8YsJfuaeu14jv9MKAJQdIrwyPHKhu49/WtTBqWyC8XTvJbSIcmxbLyljO5fPpwfrvma3706mbqm/zwzTugteaBN7ez80gVT1w5lcHx0d2/SBBMQq9LP9Ra79Za7zVqM92+nzv90Mvz9mBndkqvjC784p87aGh28PQ104m2BdbvO8Zu5amrp3H/t8azevtRrnr+U45U1Pv9+uUf7+eNTUXcNW8s87xZKn0tZVToN5i6+6FSaolSKlcplVtSUhLUGt11P7RaFBYlBUGh8vGe46zZdZw7541ljL8phZ1QSnHLeWN46YaZ5JfWcdkz6/l4j2/f3OHQ/PbDvTy15muumD6cOy4Y6/lCGa8mmBiLioC1opT6SCm1w8OfhYG8kdb6Ba11ltY6KzU1Nfgd4z0iB2cKYkBZK8JJNDS38uC/djImdQCLz/KQ7hcg549P483bvsHAAVEsfjmX23I2sfdYdZfr9hfXcMOfvmT5x/u5OiudJ78zDYvFy790X0wZFfoNFgu09nT6odZ6nqHvGAL+fHS7RZl2+PLhE7W8+mU+VQ3NzJswhAvGp/X4Id8rnx6moKyenJtnE2Uz5he2U9MSePv2s3lu3QH+8MlB3t1+lCnDk5g8PAmbRbH7aBUb88sZEGXjkUWTyZ49wvfn7ospo0K/QSo720a9ef+f3G6zmHKwxKcHTnDzK7m0tGpi7BZe/bKAK84YzhNXTm0rdAo3dU0t/P6Tg5x7WipnnTrY0LWjbVbumnca3/vGSF79ssBl3xyjxaEZMTCOu+edRvbsEQzy52BzxAjPbW/NnDIq9BssShk+6i0kIVdKXQ4sB1KBd5VSW7TW8w3ZmQe6yyMHsFnMJ+RFFfUs+fNG0lNieWXxLFLjo1n+8X4OPf0C1bf9jeTSY6gRI5wpkWE8iP3LZ3mU1TZx54VevGkDSI6L4odzx5zcMyVQjCh4EoQIYQ3D8OWQhFxr/SbwpkF78eP9nF99mQ1RVmW64cs/f3M7Dq158YaZbZ397i7+iuY1K7A3NjgvCnMPmI7R+IzMFMPXNxT351+61Gmn9MBNThCMotelH/Y0mm7SVoAom4UmE/Uj35hXztq9Jdxx4VjnsAQ3S5e2i7ibMB7o9UQ0biiSMiqYFFOnHxqCPxG5yYT82bX7GTggiuvPzDz5iR480DNVNC4IJqffC7k/HnmUzTzph8cqG1i7t5hrZmUQF9XJ5erBHjCmi8YFwcSEwyM3l5B3MyEIIMpqnoh81aZCHBq+MyOj65MeesA0RkUbfqAXUDQu1ZSCEDJKGd/G1lxC3s2EIDCPtaK1ZtXGQmaNGsjIwQO6XtCpB0z1kGHce9GP+GzOxYbuw+9oXKopBcEQwpF+aC4h98sjt9JoAmtl7/FqDp6o5fLpw71f1OFAz16Qz+dzLuZ3H30ddEfBzgQUjUs1pSAYglgrrq8+I3KTWCsfufp1Xzghza/rY+xWbp07hi8PlfHpgVJD9hCQN27k4atYNEI/RvX39EM3vjzyaJuFppbA2qZGgjW7izk9I5m0hBi/X/PdWSM4JTGG360JMSrPycGRmcn3544l9483M2P96u5fY9Thq1g0Qj/HqpRhv1W7MZWQ+/Phg81aaW518OQHe3joXzupaWwJZnt+U1zVwNaCCr4Z4NSbGLuV284fQ25eOf/ZdyK4N3cJqSU/HwuawaXH/BNSowZwiEUj9HMsShneNMtkQu76xoe1YreqoKyVlzccZsXaA7z86WF+9fbO4DboJ24Rnjsu8C6QV8/MYFhSDL8NNioPVkiNGsAhDa+Efo6lv3vkbowuCGppdfD8vw9w7mmp3Hz2KP6xsZD80rruXxgknx0sJSXOzoRTEgN+bbTNyh0XjmVrQQUf7DwW+JuHIqRGVFP2xRmpghAAFuWfuxDQmoauFmbaB0v4yiO3Btxr5cvDZZTWNnHNzAwWn+3swb1qU2HQ++yOzw6UMnvUIO/9trvhqhnpnJoWzxPv7w24QVhruoecdeg5Ie2rM1IFwU8svW34ck/T3ag3CC4iX7unmCibhfPGpTIsOZbZowYGF+36QUFZHUUV9Zw5ZlDQa9isFn528XgOnqhlZW5BQK/9+6IfUGfr1Cq2J4VUZqQK/RxJP+y+Z1bbYWcgv7psyq9g6vCktjL5c09LZc+xakqqG0PZrkc+c6UOnjlmUEhpePMmpDFzZAq/W7OPyrpmv16zKb+cB+KmsubuhyMrpNLwSujHKEU/LwhyffUl5NGuqTb+Zq40tTjYXlTJ9BHJbY+dc6rzEHLD/iAzQ3zw6YETDI6PYuxH/wosDa+T6Ku//Y0HF0yivK6Jh9/d1e37NjS38sAb2xmSGM2FD98tQioIEcLa75tmuScEddNrBfDbXvn6eDVNLQ6mZSS3PTZpWCIpcfawCPlXh8uZNWogKpDsES+515PXvcMPzxvD6xsLux1s/MT7e9lzrJrHrpxKfLSpBkMJQp/CYunv6Yeur91ZK+C/kB8oqQHgtCEJbY9ZLIozRqSwpaAimG16paS6kaKKeqZnpASWPeJD9G+/8FQmDE3kzte2sO9416HGAK99mc9LGw5xw5mZnD/Ov0pSQRDCg7ONrcFrGrtcePHnJhYVoLWy73gNVoti5KCTG1dNy0hmf0kN1Q3++c/+sNV1Y5iWkRxYGp4P0Y+2WfnjDVlE26xk//ELthVWtD2ttebPnx3mgTe3c95pqfz80okh7V8QhNCx9HePnLbuh8ZZK/uLa8gcFNdlYvzU9CS0hu1FlUHutStbCiqwWhRThicFlobXjegPT44l5+bZWC2Ky5/9lB/9bROPv7+HRSs28D//3MnccWk8m30G9h4a4iwIgnf6/WAJN92lH4L/Qr6vuJpTU+O7PD4tPRmAbYXGCfnWwgrGDUkgNsoaWBqeH6I/7pQEVt9xDtefmcnnB8v4/b8P0Nji4NErpvCH67MYIL64IPQKwlHZaar/u/25ibmjzkY/hLy51UFeaR3zJ53S5bmUAVFkDoprs0NCxeHQbCmoYMG0Ye0PZmf7lzHi57DhlAFRPLhgEg8umGTIngVBMB53HaDDoYMuCuyMuYTc9dWo9MOi8npaHNrzYAdganoyGw+XBbpNjxw8UUt1QwunuyL9gPFX9AVB6NVYXQLm0BqLT3/Bf0xlrfg16i0Aa6WwvB6AjJQ4j89PHJrIkcoGvwtufOGO7E/vkK8uCEL/wx2FG5mCGJKQK6WeVErtUUptU0q9qZRKNmhfHvF31BvgVw+SogpnSl96SqzH5ycMdaYk7jlWFcg2PbKloIL4aBtjPPjxgiD0HywuATPyvDPUiHwNMFlrPRX4Grg/9C15x69RbwFkrRSW12NRcEqS5+EOE4Y6uxPuPmqMkE8ZnoTVIE9MEARz4pYAIxtnhSTkWusPtdbuKQyfA+mhb8nX+zm/GlUQVFRez9CkWK9peWkJ0aTE2dlzzHOhjb80NLey+2iV2CqCILQFc0amIBrpkS8G3vP2pFJqiVIqVymVW1JSEtQb6PbjTq/XBFIQVFhez/Bkz7YKOPPVJwxNZHeIQr7zSBUtDs3pHdoACILQP1Fth53GrdmtkCulPlJK7fDwZ2GHa5YCLYDX9n1a6xe01lla66zU1MAn4zjXcL+f92uiAkg/LKqo9+qPuxl/SiJ7j1WF9GuQu9RfhFwQhI7ph4at2d0FWut5WuvJHv78E0Ap9T3gUiBbGz32wgu+XOZoP62VllYHRyvrGe4Wci8tZccPTaCh2UFeaW3Q+91aUMHQpBiGJPo/aFkQhL5JOKyVkPLIlVIXAz8FztNah282mgu/JgT5KeRltU04NKQlxrR3F3Q3pnK3lAUmzr0UgN1HqxkdZMbJloIKicYFQQDa9avXpB8CzwAJwBql1Bal1PMG7Mkr/k4Igu498mLX0IjU+Gif3QVPTYvHooJPQSytaSS/rO6kNrmCIPRfrGFIPwwpItdan2rURgLBH4+8u4i8pMYl5AnRPrsLxtitjE6NZ/fR4A483b1aJCIXBAF6YfphT+PPHcxqUSjlh5C7IvK0hOhuuwtOGJoYdC755oIKLApnx0NBEPo9ll6efhh2/Om1opQi2jW30xduIR8cH91td8HxpyRQVFFPZX3gpfpbCio4bUiCdB8UBAHonZWdPYo/o94AYuxWGppbvV+Qk0P2f53LwccXEHvaGOdjPlrKThwWXIWn1pqtctApCEIHTs9I4sEFE0mKsxu2prmE3P1NN1XuMTYfQu7KUEkuOYoFfVKGireBxJNcpfoNL/8loKn3h0vrqKxvFiEXBKGNU9MSuPGsUSTG9Fch96PXCkBslJX6Zi/WSiBDj12kJcaQfWA933j8fv+n3gOb8soBmD4ipZsdC4IgBI95hDwnh8lnTeXg4wuYc8EMnwIabbN4j8gDGXrcgbvXvkxUU8PJD3ZzA9iUX05CtI2xadLxUBCE8GEOIXfZIdFFhVjQxBwp9BkNx0b5sFYCGXrcgUFlxz0/4eMGsDm/gtNHJBs2BUQQBMET5hDyAO2QWLuV+iYvQr5sGdrfoccdqD9lmOcnvNwAahtb2HOsiunijwuCEGbMIeQB2iExdisNLV6EPDubst89Q2FiKrq7occdqP6fX1Fniz75QR83gK2FFTg0TM8Uf1wQhPBiDiEP0A7xGZEDh+cv4uwf/ol1u491yVDxRuqSG3nw0juoSB3a/dR7nLYKwBkZIuSCIIQXcwh5NwU7nYm2W2jwlrVCezFQany012s6Y7EoDl60iCW/WuUxRbEzm/PLGZM6wNBcUUEQBE+YQ8izs+GFF2gclo4DRcOwdJ/RcGw3BUHuPitpCf4LOcCkYYnsPFLZbY8ErTWb8ysk7VAQhB7BHEIOkJ3Npk+2MPpnb7Ppk80+o+HuKjtLqhtRCgYOiApoC2eMSKG2qZW93UwM2l9cQ2ltEzNHipALghB+zCPkdGxj6zudL9Zupb65FW9zLkqqGxk0IAqbl1md3pjhOrjcmFfm87pPD5QC8I0xgwNaP2i8DMUQBKF/YCohx49RbwAxdgsODc2t3oV8cAD+uJv0lFjSEqLZ6KrY9ManB06QnhJLxsA4n9cZgnsoRgAVp4Ig9C1MJeTdj152EmO3AlDvxV4pqWl09iEPEKUUMzJTyPUh5K0OzecHy/jGmEEBrx8UQbQcEAShb2EuIfdj1Bu0C3mjFyE/UR2ckIPTXiksr+dYZYPH53ceqaSyvrnnbJUgWw4IgtB3MJeQuz3ybkLyWB8RudaakhCE/ExXpP2ffSUen/9odzFKwdlje0jIg2w5IAhC38FcQu5n90Nf1kpVfQtNrY6Acsg7MnFoImkJ0azb61nI1+w6TlZmSlAefFAEmGMvCELfw1xC7vrabUQe5fxYnoqCSmqclkiwEblSirnjUvlkXwnNnaYQFZTVsftoFd+cOCSotYPClWPvbSiGIAh9H3MJufbvuLMtIvdQpl9c3WHocpDMmzCE6oYWPvn65Kj8H7kFKAWXTPXSYCtcZGd7HYohCELfx1xC7vraffqhU8g9Nc46aehykJw/Po3B8VH8/auCtsdaWh2szC3k3LGpDE+ODXptQRCEQDGVkOPvhCC3kHuIyNv7rMQEvQ271cIVZ6Tz8Z5i8kprAXhjcxHHqhq4dk5m0OsKgiAEQ0hCrpR6WCm1TSm1RSn1oVKqRzwFf9MPPUbkNY1E2SwkxoY21f7ms0dht1q4/43tbCus4LH39jAtI5l5E9JCWlcQBCFQQlMzeFJr/QsApdQdwP8APwh5V17Q+G5W5aYt/bDJw2FndSOp8dHd3gy6Iy0xhl8unMRPX9/GZc9sICnWzlNXTwt5XUHwl+bmZgoLC2lo8FzTIJiXmJgY0tPTsdv9654akpBrras6/DgA/FTaoN/P+bX79EN31opnayWUg86OXJ2VwajBA9hWWMm3Jp/CMPHGhR6ksLCQhIQERo4cKQFEH0JrTWlpKYWFhYwaNcqv14QakaOUWgZcD1QC5/u4bgmwBGBEkMUq2u9eK97zyEuqGw3tgTJz5EBmjhxo2HqC4C8NDQ0i4n0QpRSDBg2ipMRzrYonuvXIlVIfKaV2ePizEEBrvVRrnQHkAD/yto7W+gWtdZbWOis1NdXvDZ60hntP3cTk0TYLNouitrGly3MnguyzIgi9ERHxvkmg/67dCrnWep7WerKHP//sdGkOcGVA7x4g7jzy7j6jUooB0TZqOgl5S6uD0tqmoKs625C2sYIg9CJCzVoZ2+HHhcCe0Lbjm0AM+HgPQl5W24TWoRUDSdtYQWgnPj6+y2PPP/88f/7zn3t0H3PnzmXcuHFMmzaNmTNnsmXLlh59/0gTah75Yy6bZRtwEXCnAXvyir8eOUBCjI2ahpOF3IiqTmkbKwi++cEPfsD1118ftvW11jgcXTPScnJy2Lp1K7feeiv33nuvIe/V2up90piRtLR0tYEDIdSslbBaKR7eEejeIwc8WivuWZ0hCbm0jRV6Ib98eye7jlR1f2EATByWyIMLJgX8uoceeoj4+Hh+8pOfMHfuXGbPns3atWupqKjgxRdf5JxzzqG1tZX77ruPdevW0djYyG233cYtt9xCTU0NCxcupLy8nObmZh555BEWLlzI4cOHmT9/PrNnz2bjxo2sXr2azEzPxXdnnnkmTz75JAC1tbXcfvvt7Nixg+bmZh566CEWLlxIXV0d3/ve99ixYwfjxo3jyJEjrFixgqysLOLj47nlllv46KOPWLFiBYcPH+bpp5+mqamJ2bNn8+yzzwJw0003kZubi1KKxYsXc/fdd/P000/z/PPPY7PZmDhxIq+99hplZWUsXryYgwcPEhcXxwsvvMDUqVN56KGHOHDgAAcPHmTEiBG8+uqrQf9bhZy10pMEEpHHR9uoqGs66bH2qs4QhHzECKed4ulxQRC60NLSwpdffsnq1av55S9/yUcffcSLL75IUlISX331FY2NjZx11llcdNFFZGRk8Oabb5KYmMiJEyeYM2cOl112GQD79u3jlVdeYc6cOT7f7/3332fRokUALFu2jAsuuICXXnqJiooKZs2axbx583juuedISUlh165d7Nixg9NPP73t9bW1tcyePZvf/va37N69m8cff5wNGzZgt9u59dZbycnJYdKkSRQVFbFjxw4AKioqAHjsscc4dOgQ0dHRbY89+OCDTJ8+nbfeeouPP/6Y66+/vs362bVrF+vXryc2NrTUZXMJueurX0IeY6Og/GQLpMQIa2XZMqcn3tFekbaxQoQJJnLuKa644goAZsyYweHDhwH48MMP2bZtG6+//joAlZWV7Nu3j/T0dB544AE++eQTLBYLRUVFHD9+HIDMzEyfIp6dnU1TUxM1NTVtQvnhhx/yr3/9i9/85jeAM2UzPz+f9evXc+edTid48uTJTJ06tW0dq9XKlVc6zYb/+7//Y+PGjcycOROA+vp60tLSWLBgAQcPHuT222/nkksu4aKLLgJg6tSpZGdns2jRorabyfr161m1ahUAF1xwAaWlpVRVOX97uuyyy0IWcTCbkLcVBHWv5PFRXT3y41UNJMXa2/LMg8LdWXDpUqedMmKEU8Sl46AgeCQ62hk4Wa3WNi9Ya83y5cuZP3/+Sde+/PLLlJSUsHHjRux2OyNHjmyrXB0wYIDP98nJyWHGjBnce++93H777bzxxhtorVm1ahXjxo3ze78xMTFYrda2fd5www08+uijXa7bunUrH3zwAc8//zwrV67kpZde4t133+WTTz7h7bffZtmyZWzfvt3ne3X3mfzFXE2zXPgbkXfOIz9e1cCQRANyyKVtrCCExPz583nuuedobm4G4Ouvv6a2tpbKykrS0tKw2+2sXbuWPE82pg+UUjz88MN8/vnn7Nmzh/nz57N8+fK21OXNmzcDcNZZZ7Fy5UrAaW94E9wLL7yQ119/neLiYgDKysrIy8vjxIkTOBwOrrzySh555BE2bdqEw+GgoKCA888/n8cff5zKykpqamo455xzyHFlta1bt47BgweTmJgY+F+aD8wVkQeQgDgg2kZtUyutDo3V4lT+41WNDEkMvuuhIAgnU1dXR3p6etvPP/7xj/163c0338zhw4c544wz0FqTmprKW2+9RXZ2NgsWLGDKlClkZWUxfvz4gPcUGxvLPffcw5NPPskzzzzDXXfdxdSpU3E4HIwaNYp33nmHW2+9lRtuuIGJEycyfvx4Jk2aRFJSUpe1Jk6cyCOPPMJFF12Ew+HAbrezYsUKYmNjufHGG9uyZx599FFaW1u59tprqaysRGvNHXfcQXJyMg899BCLFy9m6tSpxMXF8corrwT8mbpDtQ9r6DmysrJ0bm5uwK97e+sRbn91M2vuPpexQxJ8XvuHTw6ybPVutj10EYkxzsYzZz32MXNGD+K3V08Lat+C0JvYvXs3EyZMiPQ2TElrayvNzc3ExMRw4MAB5s2bx969e4mKior01trw9O+rlNqotc7qfK3JInIn/uaRA1TVN5MYY8fh0BRXG2StCIJgaurq6jj//PNpbm5Ga82zzz7bq0Q8UMwl5H6OegNIGeD8R6moayY9Bcrrmmhu1SFNBhIEoW+QkJBAMK5Ab6XPHnYOdAl5Wa0zl/x4lTP1UDxyoS8RCWtUCD+B/ruaSsj97UcOkBLnFPJyV1HQ8WpnClOaCLnQR4iJiaG0tFTEvI/h7kceE+O/VpnLWnGX6PsRkrsj8nJXRH6s0inkpySJkAt9g/T0dAoLCwPqWy2YA/eEIH8xl5AHEJEnxdpRCsrqnHmqReX12CyKIeKRC30Eu93u9wQZoW9jTmvFDyW3WhTJsfa2iLywvI6hyTHYrKb6yIIgCN1iKlXzd0KQm5QBUZTVuYW8nvRk40a8CYIg9BZMJeRu/J2CNDg+muIqpzdeWF7P8BQZjiwIQt8jIpWdSqkSILAmCpFhMHAi0puIAPK5+xf99XOD+T57pta6y9DjiAi5WVBK5Xoqh+3ryOfuX/TXzw1957Ob0loRBEEQ2hEhFwRBMDki5L55IdIbiBDyufsX/fVzQx/57OKRC4IgmByJyAVBEEyOCLkgCILJESH3E6XUPUoprZQaHOm99ARKqSeVUnuUUtuUUm8qpZIjvadwopS6WCm1Vym1Xyl1X6T30xMopTKUUmuVUruUUjuVUndGek89iVLKqpTarJR6J9J7CRURcj9QSmUAFwH5kd5LD7IGmKy1ngp8Ddwf4f2EDaWUFVgBfAuYCFyjlJoY2V31CC3APVrricAc4LZ+8rnd3AnsjvQmjECE3D9+B/wUApj+bHK01h9qrVtcP34O+N9T03zMAvZrrQ9qrZuA14CFEd5T2NFaH9Vab3J9X41T1IZHdlc9g1IqHbgE+GOk92IEIuTdoJRaCBRprbdGei8RZDHwXqQ3EUaGAwUdfi6knwiaG6XUSGA68EWEt9JT/C/O4MwR4X0Ygqn6kYcLpdRHwCkenloKPIDTVulz+PrcWut/uq5ZivNX8Jye3JvQcyil4oFVwF1a66pI7yfcKKUuBYq11huVUnMjvB1DECEHtNbzPD2ulJoCjAK2uqYSpQOblFKztNbHenCLYcHb53ajlPoecClwoe7bBQdFQEaHn9Ndj/V5lFJ2nCKeo7V+I9L76SHOAi5TSn0biAESlVJ/1VpfG+F9BY0UBAWAUuowkKW1NlO3tKBQSl0MPAWcp7Xu07PElFI2nAe6F+IU8K+A/9Za74zoxsKMckYnrwBlWuu7IrydiOCKyH+itb40wlsJCfHIBW88AyQAa5RSW5RSz0d6Q+HCdaj7I+ADnAd+K/u6iLs4C7gOuMD1b7zFFaUKJkMickEQBJMjEbkgCILJESEXBEEwOSLkgiAIJkeEXBAEweSIkAuCIJgcEXJBEASTI0IuCIJgcv4/knipaUT5gW0AAAAASUVORK5CYII=
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<h1 id="%E8%87%AA%E5%8A%A8%E7%89%B9%E5%BE%81%E9%80%89%E6%8B%A9">&#33258;&#21160;&#29305;&#24449;&#36873;&#25321;<a class="anchor-link" href="#%E8%87%AA%E5%8A%A8%E7%89%B9%E5%BE%81%E9%80%89%E6%8B%A9">&#182;</a></h1>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<h2 id="%E5%8D%95%E4%B8%80%E5%8F%98%E9%87%8F%E6%B3%95%E8%BF%9B%E8%A1%8C%E7%89%B9%E5%BE%81%E9%80%89%E6%8B%A9">&#21333;&#19968;&#21464;&#37327;&#27861;&#36827;&#34892;&#29305;&#24449;&#36873;&#25321;<a class="anchor-link" href="#%E5%8D%95%E4%B8%80%E5%8F%98%E9%87%8F%E6%B3%95%E8%BF%9B%E8%A1%8C%E7%89%B9%E5%BE%81%E9%80%89%E6%8B%A9">&#182;</a></h2>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>很多场景只关心最重要的指标，忽略其他不那么重要的指标：</p>
<ul>
<li>玩具厂，根据年龄划分产品</li>
<li>金融公司，根据收入流水确定目标人群的偿债能力</li>
</ul>
<p>sklearn 中的特征选择方法：</p>
<ul>
<li>SelectPercentile: 按照百分比选择特征</li>
<li>SelectKBest: 选择最重要的K个指标</li>
</ul>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[1]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 导入某天中国A股全部股票交易信息 </span>
<span class="c1"># 上交所: http://www.sse.com.cn/market/price/report/</span>
<span class="c1"># 深交所: http://www.szse.cn/market/trend/index.html</span>


<span class="c1"># (1) 获取原始json数据</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="n">timestamp</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">*</span><span class="mi">1000</span><span class="p">))</span>
<span class="n">begin</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">end</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">2060</span><span class="p">)</span> <span class="c1">#1515</span>

<span class="c1"># http://www.sse.com.cn/market/price/report/</span>
<span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://yunhq.sse.com.cn:32041/v1/sh1/list/exchange/equity?callback=jQuery111208015895779126387_1560941576071&amp;select=date%2Ccode%2Cname%2Copen%2Chigh%2Clow%2Clast%2Cprev_close%2Cchg_rate%2Cvolume%2Camount%2Ctradephase%2Cchange%2Camp_rate%2Ccpxxsubtype%2Ccpxxprodusta&amp;order=&amp;begin=&quot;</span><span class="o">+</span><span class="n">begin</span><span class="o">+</span><span class="s2">&quot;&amp;end=&quot;</span><span class="o">+</span><span class="n">end</span><span class="o">+</span><span class="s2">&quot;&amp;_=&quot;</span><span class="o">+</span><span class="n">timestamp</span><span class="p">;</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;url=&quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>

<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.162 Safari/537.36&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Referer&#39;</span><span class="p">:</span> <span class="s1">&#39;http://www.sse.com.cn/market/price/report/&#39;</span>
<span class="p">}</span>

<span class="kn">import</span> <span class="nn">requests</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span> <span class="c1">#, auth=(&#39;user&#39;, &#39;pass&#39;)</span>
<span class="c1">#rs1=r.status_code #200</span>
<span class="c1">#rs2=r.headers[&#39;content-type&#39;] #&#39;text/html; charset=utf-8&#39;</span>
<span class="c1">#rs3=r.encoding #&#39;utf-8&#39; 编码，修改编码</span>
<span class="n">rs4</span><span class="o">=</span><span class="n">r</span><span class="o">.</span><span class="n">text</span>
<span class="c1">#r.json() #只有r.headers[&#39;content-type&#39;]为json时才能用。否则报错。</span>
<span class="c1">#print(rs1,rs2,rs3,&quot;\n&quot;)</span>
<span class="c1">#rs4 #现在是字符串格式</span>

<span class="c1"># (2) 解析json格式为python数组</span>
<span class="kn">import</span> <span class="nn">json</span><span class="o">,</span><span class="nn">re</span>
<span class="c1">#json</span>
<span class="n">rs</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;jQuery111208015895779126387_1560941576071\(&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">rs4</span><span class="p">)</span>
<span class="n">rs</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\)$&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">rs</span><span class="p">)</span>
<span class="n">rs</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span><span class="n">rs</span><span class="p">[</span><span class="s1">&#39;list&#39;</span><span class="p">])</span> <span class="p">)</span>  <span class="c1">#25</span>

<span class="c1"># (3) 注释每一列的字段名</span>
<span class="c1"># select: code,name,open,high,low,last,prev_close,chg_rate,volume,amount,tradephase,change,amp_rate</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;date code,name,open,high,low,last,prev_close,chg_rate,volume,amount,tradephase,change,amp_rate cpxxsubtype cpxxprodusta&#39;</span><span class="p">)</span>
<span class="n">titles</span><span class="o">=</span><span class="s1">&#39;date,code,name,open,high,low,last,prev_close,chg_rate,volume,amount,tradephase,change,amp_rate,cpxxsubtype,cpxxprodusta&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>

<span class="c1">#data</span>
<span class="n">alists</span><span class="o">=</span><span class="n">rs</span><span class="p">[</span><span class="s1">&#39;list&#39;</span><span class="p">]</span>
<span class="c1">#len(alist) #1515</span>
<span class="nb">print</span><span class="p">(</span><span class="n">alists</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">alist</span><span class="o">=</span><span class="n">alists</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">titles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="n">alist</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">alists2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">alists</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">alists2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1">#(2050, 13)</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">stock</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">alists2</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">titles</span><span class="p">)</span>
<span class="n">stock</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="c1"># 涨跌幅 chg_rate(%)</span>
<span class="c1"># 振幅 amp_rate</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>url= http://yunhq.sse.com.cn:32041/v1/sh1/list/exchange/equity?callback=jQuery111208015895779126387_1560941576071&amp;select=date%2Ccode%2Cname%2Copen%2Chigh%2Clow%2Clast%2Cprev_close%2Cchg_rate%2Cvolume%2Camount%2Ctradephase%2Cchange%2Camp_rate%2Ccpxxsubtype%2Ccpxxprodusta&amp;order=&amp;begin=0&amp;end=2060&amp;_=1636988436812
2050
date code,name,open,high,low,last,prev_close,chg_rate,volume,amount,tradephase,change,amp_rate cpxxsubtype cpxxprodusta
[20211115, &#39;600000&#39;, &#39;浦发银行&#39;, 8.66, 8.75, 8.65, 8.75, 8.65, 1.16, 27625801, 240602624, &#39;E110&#39;, 0.1, 1.16, &#39;ASH&#39;, &#39;   D  F  N          &#39;]
0 date = 20211115
1 code = 600000
2 name = 浦发银行
3 open = 8.66
4 high = 8.75
5 low = 8.65
6 last = 8.75
7 prev_close = 8.65
8 chg_rate = 1.16
9 volume = 27625801
10 amount = 240602624
11 tradephase = E110
12 change = 0.1
13 amp_rate = 1.16
14 cpxxsubtype = ASH
15 cpxxprodusta =    D  F  N          
(2050, 16)
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[1]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>code</th>
      <th>name</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>last</th>
      <th>prev_close</th>
      <th>chg_rate</th>
      <th>volume</th>
      <th>amount</th>
      <th>tradephase</th>
      <th>change</th>
      <th>amp_rate</th>
      <th>cpxxsubtype</th>
      <th>cpxxprodusta</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>20211115</td>
      <td>600000</td>
      <td>浦发银行</td>
      <td>8.66</td>
      <td>8.75</td>
      <td>8.65</td>
      <td>8.75</td>
      <td>8.65</td>
      <td>1.16</td>
      <td>27625801</td>
      <td>240602624</td>
      <td>E110</td>
      <td>0.1</td>
      <td>1.16</td>
      <td>ASH</td>
      <td>D  F  N</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20211115</td>
      <td>600004</td>
      <td>白云机场</td>
      <td>12.65</td>
      <td>12.71</td>
      <td>12.5</td>
      <td>12.51</td>
      <td>12.73</td>
      <td>-1.73</td>
      <td>13532530</td>
      <td>170390064</td>
      <td>E110</td>
      <td>-0.22</td>
      <td>1.65</td>
      <td>ASH</td>
      <td>D  F  N</td>
    </tr>
    <tr>
      <th>2</th>
      <td>20211115</td>
      <td>600006</td>
      <td>东风汽车</td>
      <td>7.07</td>
      <td>7.16</td>
      <td>6.9</td>
      <td>6.94</td>
      <td>7.09</td>
      <td>-2.12</td>
      <td>32560993</td>
      <td>227359342</td>
      <td>E110</td>
      <td>-0.15</td>
      <td>3.67</td>
      <td>ASH</td>
      <td>D  F  N</td>
    </tr>
    <tr>
      <th>3</th>
      <td>20211115</td>
      <td>600007</td>
      <td>中国国贸</td>
      <td>14.6</td>
      <td>14.9</td>
      <td>14.25</td>
      <td>14.81</td>
      <td>14.6</td>
      <td>1.44</td>
      <td>5293865</td>
      <td>77362085</td>
      <td>E110</td>
      <td>0.21</td>
      <td>4.45</td>
      <td>ASH</td>
      <td>D  F  N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>20211115</td>
      <td>600008</td>
      <td>首创环保</td>
      <td>3.18</td>
      <td>3.22</td>
      <td>3.15</td>
      <td>3.21</td>
      <td>3.19</td>
      <td>0.63</td>
      <td>79820965</td>
      <td>254427365</td>
      <td>E110</td>
      <td>0.02</td>
      <td>2.19</td>
      <td>ASH</td>
      <td>D  F  N</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[2]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">stock</span><span class="p">[</span><span class="s2">&quot;cpxxsubtype&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stock</span><span class="p">[</span><span class="s2">&quot;cpxxprodusta&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>[&#39;ASH&#39; &#39;KSH&#39; &#39;BSH&#39;]
[&#39;   D  F  N          &#39; &#39;   S  F  N          &#39; &#39;   D  FU N          &#39;
 &#39;N  D  F  N          &#39; &#39;   D  F WN          &#39; &#39;   D  FUWN          &#39;
 &#39;   DY F WN          &#39;]
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[3]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span><span class="o">=</span><span class="n">stock</span><span class="p">[</span><span class="s2">&quot;chg_rate&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tmp</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

<span class="n">tmp</span><span class="o">=</span><span class="n">stock</span><span class="p">[</span><span class="s2">&quot;amp_rate&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tmp</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>-10.31 	 71.16
0.0 	 37.82
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[4]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># target 涨幅列</span>
<span class="n">y</span><span class="o">=</span><span class="n">stock</span><span class="p">[</span><span class="s1">&#39;chg_rate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>(2050,)
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[4]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
<pre>1.16</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[5]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 特征</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">stock</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;open,high,low,last,prev_close,volume,amount,change,amp_rate&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">X</span><span class="o">=</span><span class="n">features</span><span class="o">.</span><span class="n">values</span>

<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>(2050, 9)
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[5]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
<pre>array([[8.66000000e+00, 8.75000000e+00, 8.65000000e+00, 8.75000000e+00,
        8.65000000e+00, 2.76258010e+07, 2.40602624e+08, 1.00000000e-01,
        1.16000000e+00]])</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[6]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 由于各个列差异较大，需要标准化</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">62</span><span class="p">)</span>

<span class="c1"># 数据预处理</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_train_scaled</span><span class="o">=</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_scaled</span><span class="o">=</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># 设置神经网络层数和alpha</span>
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPRegressor</span>
<span class="n">mlpr</span><span class="o">=</span><span class="n">MLPRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">62</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">mlpr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># 打分</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;training set:</span><span class="si">{:0.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="n">mlpr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">))</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tesing set:</span><span class="si">{:0.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="n">mlpr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span> <span class="p">)</span>

<span class="c1"># 打分挺高了</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>training set:0.992
tesing set:0.982
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[7]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 列举涨跌幅&gt;=10%</span>
<span class="n">wanted</span><span class="o">=</span><span class="n">stock</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">,</span><span class="s2">&quot;code&quot;</span><span class="p">,</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;last&quot;</span><span class="p">,</span> <span class="s2">&quot;prev_close&quot;</span><span class="p">,</span> <span class="s2">&quot;chg_rate&quot;</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;涨停榜</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">wanted</span><span class="p">[</span><span class="n">y</span><span class="o">&gt;=</span><span class="mi">9</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;chg_rate&#39;</span><span class="p">,</span> <span class="s2">&quot;last&quot;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">]</span> <span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">跌停榜</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">wanted</span><span class="p">[</span><span class="n">y</span><span class="o">&lt;=</span> <span class="o">-</span><span class="mi">9</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;chg_rate&#39;</span><span class="p">,</span> <span class="s2">&quot;last&quot;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">]</span> <span class="p">))</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>涨停榜
           date    code    name    last prev_close chg_rate
515   20211115  600640   新国脉     14.86      13.51     9.99
1110  20211115  603138    海量数据   18.71      17.01     9.99
1612  20211115  605300    佳禾食品   21.13      19.21     9.99
470   20211115  600587    新华医疗    22.8      20.73     9.99
1617  20211115  605333    沪光股份   24.77      22.52     9.99
1604  20211115  605277    新亚电子    37.1      33.73     9.99
1056  20211115  603050    科林电气   19.28      17.53     9.98
1176  20211115  603286    日盈电子   19.51      17.74     9.98
1453  20211115  603869    新智认知    9.92       9.02     9.98
312   20211115  600379    宝光股份   12.46      11.33     9.97
1312  20211115  603603    博天环境     7.4       6.73     9.96
175   20211115  600215    长春经开    9.16       8.33     9.96
1231  20211115  603377    东方时尚    9.28       8.44     9.95
1762  20211115  688185   康希诺     272.8      248.3     9.87
1714  20211115  688097    博众精工    48.4      44.33     9.18
1777  20211115  688212  N澳华      38.51       22.5    71.16
1720  20211115  688105   N诺唯赞    85.35       55.0    55.18
1717  20211115  688100    威胜信息    29.5       25.3     16.6
1954  20211115  688668    鼎通科技    66.0       58.0    13.79
1957  20211115  688676    金盘科技   35.42       31.4     12.8
1830  20211115  688330   宏力达    135.88      122.5    10.92
1173  20211115  603278    大业股份    9.74       8.85    10.06
77    20211115  600101    明星电力     6.9       6.27    10.05
234   20211115  600285    羚锐制药   11.84      10.76    10.04
1254  20211115  603458    勘设股份   11.95      10.86    10.04
1327  20211115  603626    科森科技   14.58      13.25    10.04
359   20211115  600452    涪陵电力   18.87      17.15    10.03
570   20211115  600706    曲江文旅    7.02       6.38    10.03
1085  20211115  603099   长白山     11.75      10.68    10.02
1285  20211115  603556    海兴电力   13.95      12.68    10.02
1373  20211115  603703    盛洋科技   17.35      15.77    10.02
1146  20211115  603213    镇洋发展   10.44       9.49    10.01
1086  20211115  603100    川仪股份   19.34      17.58    10.01
1593  20211115  605198    德利股份   19.46      17.69    10.01
839   20211115  601126    四方股份   20.23      18.39    10.01
1165  20211115  603258    电魂网络   30.21      27.46    10.01
1601  20211115  605259    绿田机械   35.72      32.47    10.01
1472  20211115  603897    长城科技   52.99      48.17    10.01
1321  20211115  603613    国联股份   120.4     109.45     10.0
1573  20211115  605133    嵘泰股份   22.66       20.6     10.0
738   20211115  600892    大晟文化    3.74        3.4     10.0
1043  20211115  603031   安德利     39.82       36.2     10.0
321   20211115  600389    江山股份   42.24       38.4     10.0
1384  20211115  603719    良品铺子   46.07      41.88     10.0
196   20211115  600237    铜峰电子    6.93        6.3     10.0
1560  20211115  605089   味知香     77.25      70.23     10.0

跌停榜
           date    code   name   last prev_close chg_rate
1505  20211115  603959   百利科技  18.12      20.13    -9.99
1499  20211115  603948   建业股份  35.03      38.92    -9.99
1264  20211115  603505   金石资源  38.84      43.15    -9.99
1788  20211115  688233   神工股份   81.5      90.55    -9.99
120   20211115  600151   航天机电  11.84      13.15    -9.96
550   20211115  600683   京投发展    6.8       7.55    -9.93
542   20211115  600673  东阳光     9.52      10.57    -9.93
865   20211115  601218   吉鑫科技   7.03       7.79    -9.76
83    20211115  600108   亚盛集团   3.56       3.94    -9.64
1858  20211115  688390  固德威    422.5      467.0    -9.53
1401  20211115  603766   隆鑫通用   5.71       6.31    -9.51
1842  20211115  688359   三孚新科   58.0      64.67   -10.31
139   20211115  600172   黄河旋风  11.04      12.27   -10.02
72    20211115  600096  云天化    23.55      26.17   -10.01
1078  20211115  603088   宁波精达  13.77       15.3    -10.0
1488  20211115  603922  金鸿顺     23.4       26.0    -10.0
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<h3 id="%E4%BD%BF%E7%94%A8-SelectPercentile-%E8%BF%9B%E8%A1%8C%E7%89%B9%E5%BE%81%E9%80%89%E6%8B%A9">&#20351;&#29992; SelectPercentile &#36827;&#34892;&#29305;&#24449;&#36873;&#25321;<a class="anchor-link" href="#%E4%BD%BF%E7%94%A8-SelectPercentile-%E8%BF%9B%E8%A1%8C%E7%89%B9%E5%BE%81%E9%80%89%E6%8B%A9">&#182;</a></h3>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[8]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">SelectPercentile</span>
<span class="c1">#设置特征选择参数</span>
<span class="n">select</span> <span class="o">=</span> <span class="n">SelectPercentile</span><span class="p">(</span><span class="n">percentile</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">select</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">X_train_selected</span> <span class="o">=</span> <span class="n">select</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">)</span>

<span class="c1"># 输出维度</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_train_selected</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1">#9列变为4列</span>

<span class="c1"># 查看哪些被保留了</span>
<span class="n">mask</span><span class="o">=</span><span class="n">select</span><span class="o">.</span><span class="n">get_support</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>(1537, 9) (1537, 4)
[False False False False False  True  True  True  True]
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[9]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 使用图像表示特征选择的结果</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">cool</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Featuers Selected&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># 红色是保留的。</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[10]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 再次使用选择的特征，训练神经网络</span>
<span class="n">X_test_selected</span><span class="o">=</span><span class="n">select</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>

<span class="c1"># 设置神经网络层数和alpha</span>
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPRegressor</span>
<span class="n">mlpr_sp</span><span class="o">=</span><span class="n">MLPRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">62</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">mlpr_sp</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_selected</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># 打分</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;training set:</span><span class="si">{:0.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="n">mlpr_sp</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train_selected</span><span class="p">,</span> <span class="n">y_train</span><span class="p">))</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tesing set:</span><span class="si">{:0.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="n">mlpr_sp</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test_selected</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span> <span class="p">)</span>

<span class="c1"># 打分降低了。</span>
<span class="c1"># 说明我们的数据不包括噪音，去掉的都是有用的信息。</span>

<span class="c1"># 单一变量法进行特征筛选，不依赖于具体建模的算法。</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>training set:0.974
tesing set:0.943
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<h2 id="%E5%9F%BA%E4%BA%8E%E6%A8%A1%E5%9E%8B%E7%9A%84%E7%89%B9%E5%BE%81%E9%80%89%E6%8B%A9">&#22522;&#20110;&#27169;&#22411;&#30340;&#29305;&#24449;&#36873;&#25321;<a class="anchor-link" href="#%E5%9F%BA%E4%BA%8E%E6%A8%A1%E5%9E%8B%E7%9A%84%E7%89%B9%E5%BE%81%E9%80%89%E6%8B%A9">&#182;</a></h2>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>步骤：先使用一个监督学习模型，判断数据特征的重要性，保留最重要的特征。</p>
<ul>
<li>这一步使用的模型和最终使用的不一定一样。</li>
</ul>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[11]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 导入基于模型选择特征的工具</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">SelectFromModel</span>

<span class="c1"># 导入随机森林模型</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>

<span class="c1"># 设置模型 n_estimators 参数</span>
<span class="n">sfm</span><span class="o">=</span><span class="n">SelectFromModel</span><span class="p">(</span><span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">38</span><span class="p">),</span> <span class="n">threshold</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">)</span>

<span class="c1"># 使用模型拟合数据</span>
<span class="n">sfm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">X_train_sfm</span> <span class="o">=</span><span class="n">sfm</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">)</span>

<span class="c1"># 打印形状</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_train_sfm</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1">#9列变5列</span>


<span class="c1"># 查看哪些被保留了</span>
<span class="n">mask_sfm</span><span class="o">=</span><span class="n">sfm</span><span class="o">.</span><span class="n">get_support</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mask_sfm</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>(1537, 9) (1537, 5)
[ True False False False  True  True False  True  True]
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[12]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 使用图像表示特征选择的结果</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">mask_sfm</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">cool</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Featuers Selected&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 红色是保留的。随机森林法 和 单一变量法，选择的特征不同。</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[13]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 再次使用选择的特征，训练神经网络</span>
<span class="n">X_test_sfm</span><span class="o">=</span><span class="n">sfm</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>

<span class="c1"># 设置神经网络层数和alpha</span>
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPRegressor</span>
<span class="n">mlpr_sfm</span><span class="o">=</span><span class="n">MLPRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">62</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">mlpr_sfm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_sfm</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># 打分</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;training set:</span><span class="si">{:0.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="n">mlpr_sfm</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train_sfm</span><span class="p">,</span> <span class="n">y_train</span><span class="p">))</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tesing set:</span><span class="si">{:0.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="n">mlpr_sfm</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test_sfm</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span> <span class="p">)</span>

<span class="c1"># 打分比原始的降低了。但是比单一变量法略高。</span>
<span class="c1"># 说明我们的数据不包括噪音，去掉的都是有用的信息。 </span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>training set:0.989
tesing set:0.976
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<h2 id="%E8%BF%AD%E4%BB%A3%E5%BC%8F%E7%89%B9%E5%BE%81%E9%80%89%E6%8B%A9">&#36845;&#20195;&#24335;&#29305;&#24449;&#36873;&#25321;<a class="anchor-link" href="#%E8%BF%AD%E4%BB%A3%E5%BC%8F%E7%89%B9%E5%BE%81%E9%80%89%E6%8B%A9">&#182;</a></h2>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>递归特征剔除法(Recursive Feature Elimination, RFE): <a href="https://machinelearningmastery.com/rfe-feature-selection-in-python/">https://machinelearningmastery.com/rfe-feature-selection-in-python/</a></p>
<ul>
<li>使用某个模型对特征进行筛选，之后建立2个模型，去掉某个特征前后的模型，</li>
</ul>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[14]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">RFE</span>
<span class="n">rfe</span><span class="o">=</span><span class="n">RFE</span><span class="p">(</span><span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">38</span><span class="p">),</span> <span class="n">n_features_to_select</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">rfe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">mask</span><span class="o">=</span><span class="n">rfe</span><span class="o">.</span><span class="n">get_support</span><span class="p">()</span>
<span class="n">mask</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[14]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
<pre>array([ True, False,  True, False,  True, False, False,  True,  True])</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[15]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 使用图像表示特征选择的结果</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">cool</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Featuers Selected&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[16]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 再次使用选择的特征，训练神经网络</span>
<span class="n">X_train_rfe</span><span class="o">=</span><span class="n">rfe</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">)</span>
<span class="n">X_test_rfe</span><span class="o">=</span><span class="n">rfe</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>

<span class="c1"># 设置神经网络层数和alpha</span>
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPRegressor</span>
<span class="n">mlpr_rfe</span><span class="o">=</span><span class="n">MLPRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">62</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">mlpr_rfe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_rfe</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># 打分</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;training set:</span><span class="si">{:0.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="n">mlpr_rfe</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train_rfe</span><span class="p">,</span> <span class="n">y_train</span><span class="p">))</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tesing set:</span><span class="si">{:0.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="n">mlpr_rfe</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test_rfe</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span> <span class="p">)</span>

<span class="c1"># 打分比原始的略高，最好的结果了。</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>training set:0.992
tesing set:0.986
</pre>
</div>
</div>

</div>

</div>

</div>
</body>







</html>
